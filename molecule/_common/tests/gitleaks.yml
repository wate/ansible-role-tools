---
- name: Check gitleaks command
  ansible.builtin.stat:
    path: /usr/local/bin/gitleaks
  register: gitleaks_command_result
- name: Assert installed gitleaks
  ansible.builtin.assert:
    that:
      - gitleaks_command_result.stat.exists
      - gitleaks_command_result.stat.executable
    fail_msg: "gitleaks command is not installed or not executable"
    success_msg: "gitleaks command is installed and executable"
